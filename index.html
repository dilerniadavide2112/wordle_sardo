<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Wordle Sardo</title>
<style>
/* ===== RESET & BASE ===== */
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #111;
  color: #eee;
  min-height: 100vh;
  display: flex;
  justify-content: center;
}
.container {
  width: 100%;
  max-width: 420px;
  padding: 10px;
  display: flex;
  flex-direction: column;
  min-height: 100vh; /* Forza il contenuto a occupare lo schermo */
  justify-content: flex-start; /* Allinea tutto verso l'alto */
}

#game {
  margin-top: 10px;
  margin-bottom: 10px; /* Spazio tra griglia e tastiera */
}
header {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
h1 { letter-spacing: .3em; margin: 0; }
.menu-btn { font-size: 26px; cursor: pointer; user-select: none; }

/* ===== GAME GRID ===== */
#game {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.row {
  width: 100%;
  display: flex;
  justify-content: center; /* Centra le caselle */
  gap: 5px;               /* Crea uno spazio uniforme tra le caselle */
  margin-bottom: 5px;      /* Spazio tra le righe */
}

.cell {
  width: 60px;             /* Larghezza fissa o variabile ma controllata */
  height: 60px;
  aspect-ratio: 1/1;
  border: 2px solid #333;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2rem;
  font-weight: bold;
  text-transform: uppercase;
  user-select: none;
}
.correct { background: #538d4e; border-color: #538d4e; }
.present { background: #b59f3b; border-color: #b59f3b; }
.absent  { background: #3a3a3c; border-color: #3c3c3c; }

/* ===== KEYBOARD ===== */
/* ===== KEYBOARD - Layout ottimizzato per Mobile ===== */
#keyboard {
  width: 100%;
  max-width: 450px; /* Limita la larghezza massima per non allontanarsi troppo dalla griglia */
  margin: 15px auto 0; /* Margine superiore ridotto per avvicinarla alla griglia */
  display: flex;
  flex-direction: column;
  gap: 8px; /* Spazio verticale tra le file */
  touch-action: manipulation;
}

.keyrow {
  width: 100%;
  display: flex;
  justify-content: center;
  gap: 4px; /* Spazio orizzontale tra i tasti */
}

#keyboard button {
  all: unset;
  height: 58px; /* Altezza standard Wordle */
  background: #818384;
  color: #fff;
  border-radius: 4px;
  font-weight: 700;
  font-size: 1.2rem;
  cursor: pointer;
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: center;
  flex: 1; /* Distribuzione equa */
  min-width: 0;
}

/* Tasti speciali piÃ¹ larghi (ENTER e CANC) */
#keyboard .wide {
  flex: 1.5; 
  font-size: 0.9rem; /* Testo leggermente piÃ¹ piccolo per far stare ENTER */
}

/* Effetto alla pressione */
#keyboard button:active {
  background: #666;
}
/* ===== MESSAGES ===== */
#msg { height: 22px; margin: 4px; color: #ff6666; font-size: 14px; }

/* ===== OVERLAYS ===== */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.7);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
.show { display: flex; }
.modal {
  background: #222;
  padding: 20px;
  border-radius: 12px;
  width: 90%;
  max-width: 400px;
  max-height: 85vh;
  overflow-y: auto;
  text-align: center;
  display: flex; /* Aggiunto per centrare i figli */
  flex-direction: column;
  align-items: center;
}

#solution {
  white-space: pre; /* Mantiene i ritorni a capo ma ignora il wrapping automatico fastidioso */
  font-family: 'Courier New', Courier, monospace;
  font-size: 20px;
  line-height: 1.2;
  margin: 15px 0;
  display: block;
  text-align: center;
  width: 100%; /* Occupa tutto lo spazio per centrare il testo interno */
}

/* ===== MENU ===== */
.menu {
  position: absolute;
  top: 48px;
  right: 12px;
  background: #222;
  border-radius: 10px;
  padding: 10px;
  display: none;
  z-index: 5;
}
.menu button {
  display: block;
  width: 100%;
  margin: 6px 0;
}
button {
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
.primary { background: #538d4e; color: #fff; }
.secondary { background: #555; color: #fff; }


/* Animazione Flip */
@keyframes flip {
  0% { transform: rotateX(0); }
  45% { transform: rotateX(90deg); }
  55% { transform: rotateX(90deg); }
  100% { transform: rotateX(0); }
}

.cell.flip {
  animation: flip 0.6s ease-in-out forwards;
}

/* Opzionale: un piccolo rimbalzo quando scrivi una lettera */
.cell.pop {
  transform: scale(1.1);
  border-color: #565758;
}
  
</style>
</head>
<body>

<!-- START OVERLAY -->
<div id="startOverlay" class="overlay show">
  <div class="modal">
    <h2>WORDLE SARDO</h2>
    <button class="primary" id="startPlay">GIOCA</button>
    <button class="secondary" id="openRules">REGOLE</button>
  </div>
</div>

<!-- RULES OVERLAY -->
<div id="rulesOverlay" class="overlay">
  <div class="modal">
    <h2>REGOLE</h2>
    <p>Indovina sa parola de 5 letras in 6 tentativos.</p>
    <p>ðŸŸ© giusta e postu giustu</p>
    <p>ðŸŸ¨ giusta postu sbagliadu</p>
    <p>â¬› non est in sa parola</p>
    <button class="primary" id="rulesOk">OK</button>
  </div>
</div>

<!-- END / RESULT OVERLAY -->
<div id="overlay" class="overlay">
  <div class="modal">
    <h2 id="result"></h2>
    <pre id="solution"></pre>
    <button class="primary" id="shareBtn">Condividi</button>
    <button class="secondary" id="closeBtn">Chiudi</button>
  </div>
</div>

<!-- MAIN CONTAINER -->
<div class="container">
  <header>
    <h1>WORDLE</h1>
    <div class="menu-btn" id="menuBtn">â˜°</div>
  </header>

  <!-- MENU A TENDINA -->
  <div class="menu" id="menu">
  <button class="secondary" id="menuRules">Regole</button>
  <button class="secondary" id="menuSurrender" style="color: #ff6666; font-weight: bold;">Arrenditi</button>
  <button class="secondary" id="menuClose">Chiudi</button>
</div>

  <!-- GAME GRID -->
  <div id="game"></div>
  <div id="msg"></div>
  <div class="game-controls" style="display: flex; justify-content: center; gap: 10px; margin-bottom: 10px;">
    <button id="helpBtn" style="background: #2d5a88; color: white; padding: 10px 15px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer;">AXUDU</button>
    <button id="surrenderBtn" style="background: #882d2d; color: white; padding: 10px 15px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer;">RENDA-DI</button>
</div>

  <!-- VIRTUAL KEYBOARD -->
  <div id="keyboard">
    <div class="keyrow">
      <button>Q</button><button>W</button><button>E</button><button>R</button>
      <button>T</button><button>Y</button><button>U</button><button>I</button>
      <button>O</button><button>P</button>
    </div>
    <div class="keyrow">
      <button>A</button><button>S</button><button>D</button><button>F</button>
      <button>G</button><button>H</button><button>J</button><button>K</button>
      <button>L</button>
    </div>
    <div class="keyrow">
      <button class="wide">ENTER</button>
      <button>Z</button><button>X</button><button>C</button>
      <button>V</button><button>B</button><button>N</button><button>M</button>
      <button class="wide">âŒ«</button>
    </div>
  </div>
</div>
<script>
let gameEnabled = false;

const WORDS = ["cantu","terra","limba","domus","abbae","abbas","agusu","akatu", "amore","annos","arras","artu","asinu","attzu","bacca","ballu","battu", "berru","bidda","binu","boghe","bonu","braxu","bussu","cabbu", "caded", "camin","campu","canes","capru","carri","ceddu","chelu","chena","chida", "chidu","coggi","conca","corru","costa","craba","crobu","cuadu","curre", "dente","dinai","dridu","fangu","fattu","femmu", "ferro","figus","filu", "foghe","forru","fradi","frori","fundu","gattu","genna","giara","goccu", "granu","herra","ibidu","istru","latte","legnu","libru","littu","logu", "macas","manus","mattu","melis","menta", "merca","metru","missa","molle", "monte","moru","mughe","nassa","niedu","ninnu","nuddu","olivu","omini", "orru","pane","pedde","perda","pietu","pilus","pinna","pitzus","planu", "ponte","porru","pratu","prenu", "punta","putzu","rabbu","randa","rattu", "riccu","rimas","rinnu","rocca","roghe","rueda","sabba","santu","sartu", "sedda","serra","siddu","sinnu","solee","sonnu","spina","stadu","stolu", "suddu","tabba","tanca", "tattu","terru","tissu","torru","trigu","umbra", "undas","ungra","usciu","vacca","valle","vesta","vidda","vinu","virga", "zente","zinnu","bentu","abbae","abbas","abidu","acqua","addiu","agudu","aiadu","ajudu","alidu", "altu","amadu","amare","ambra","annos","ansia","apriu","aridu","arras","artu","asinu","attzu","auras","azotu", "bacas","bagna","ballu","battu","beidu","bentu","berru","bidda","binu","boghe","bonu","braxu","bravu","bussu", "cabbu","caded","camin","campu","canes","capru","carri","ceddu","chelu","chena", "chida","chidu","coggi","coldu","conca","corru","costa","craba","crobu","cuadu","curre","dente","dinai","domus","dridu","durus","fache","fangu", "fattu","femmu","ferro","figus","filu","foghe", "forru","fradi","fridu","frori","fundu","gattu","genna","giara","goccu","granu","herra","ibidu","imidu","istru","lattu","latte","legnu","libru","littu","logu","luciu","macas","maled", "manus", "mariu","mattu","melis","menta","merca","metru","missa","moddu","molle","monte","moru","mughe","nassa","niedu","ninnu","nuddu","olivu","omini","orrua","ossu","paber","panee","pannu","pedde", "perda","pesca","piana","pietu", "pilus","pinna","pintu","pitzus","planu","ponte","porru","pratu","prenu","punta","putzu","rabbu","randa","rattu","regnu","riccu","rimas","rinnu","rocca","roghe", "rueda","sabba","santu","sartu","sedda","serra","siddu","sinnu","solee", "sonnu","spada","spina","stadu","stolu","suddu","tabba","tanca","tattu","tenre","terru","tissu","torru","trigu","umbra", "undas","ungra","usciu","vacua","vacca","valle","vesta","vidda","vinu","virga","zente","zinnu","zoccu","abbidu", "abbaru","abeta","abidu","abinu","accas","acidu","acutu","agidu","ajuru","alenu", "alidu","amada","amidu","anniu","apidu","aratu","ardiu","aridu","arriu","aspre","attiu","augas","bagna","baldu","balia","barca","bentu","bidas","bighe", "bionu","boidu","bolla","branu","brida", "brutu","cabra","cairu","caldu","cantu","carbu","caria","casca","cattu","cennu","chena","cibru","coddu","cortu","cress","cuasi","curdu","dannu","deidu","dertu","doble","doltu","draga","durra", "faina","fattu","feddu","filla","finas","fitta","flori","foras","fremu","fridu","fundu","gabbu","galdu","garbu","gattu","ghidu","giogu","gradu","ibadu","impon","incas","infiu","intre","isola", "istau","laduu","lamas","lassu","lentu", "limba","linna","littu","lobiu","luddu","lumen","macas","madru","malas","manca","mardu","mascu","matta","meldu","mentu","mesti","millu","modda","mundu", "murta","nassa","niedu","noddu","noras","notte","ogliu","omadu","onore","opidu", "orosu","ossia","paber","pagae","palas","pandu","parru","pattu","pedru","penna","pesas","pillu","pinna","piras", "poddu","poldu","prama","prena","puddu","puntu","raddu","ramas","randa","redda","rescu","riccu","rissu","rivas","robba", "ruddu","sabba","sacru","saldu","sanas","sardu","seddu","senna","serru", "sessa","sibiu","simba","sinna","soddu","soldu","sonnu","spadu","stela","stidu","suddu","tanca","tardu","tella","tenni","terra","tinta","tittu","torra","tundu", "turre","umbra","ungiu","usura", "vacua","vagus","valdu","varra","veddu","veldu","venna","verru","vidda","vigiu","virga","zinnu","zoccu","aberu","aeras","afidu","ainas","ainos","amigu","amore","ampru","andat","anima","antru", "aostu", "arbus","arena","armas","artes","ascia","asulu","badde","banca","bannu","basca","bator","belus","benit","birde","borta","bosas","botru","brodu","bujiu","busta","caddu","calae","canna", "carga","carru","carta","casus","catza","cerva", "chitu","cibus","cimas","cintu","codas","conto","coros","cosas","cozzu","crara","creja","crona","cruce","culos","cursu","custu","daret","datas", "deche","ditzu","dolos","donzi","dromi","duos","ebbas","erbas","faghu","fames","favas", "festa","filas","fizos","fogus","folas","forte","funes","furas","fuste","ganas","gioia","giras","gomai", "gopai","gustu","janas","janna","josso","justu","lanas","lardu","largu","lebiu","lenas","lezes","linas","lizus","longu","luche", "lunas","maccu","malus","mamas","mamma","mancu","maris","marra", "matas","meigu","melas","mesus","miras","modde","molas","moras","mudus","mulas","mulus","muras","murus","musca","muscu","narat","naris","nasus","neula","nosus","nughe", "nuras","odius","olias", "ortus","ossas","ozzus","panis","paras","parte","passu","pazas","pedes","penas","perla","petza","pigat","pinta","pisci","pisus","pitzu","ponit","porcu","posta","pruna","pudda","pupas","ranas", "renas","resta", "robas","rodas","rosas","ruius","sacca","salas","scala","scola","segat","segus","serus","siccu","sinus","sogas","sorus","sucus","taula","tazas", "telas","tempu","tetas","tontu", "tostu","totus","tuvus","tzius","usat","vacas","vasat","vasus","velas","venas","vidas","visus","vitas","zassu","zegus","zelus","zerru","zestu","ziras","zonas","zuras"];
const WORD_SET = new Set(WORDS);

const epoch = new Date(2023, 0, 1);
const dayIndex = Math.floor((Date.now() - epoch) / 86400000);
const solution = WORDS[dayIndex % WORDS.length];

const maxRows = 6;
let currentRow = 0;
let currentGuess = "";
let guesses = [];

const game = document.getElementById("game");
game.style.visibility = "visible";
const rows = [];

// Creazione griglia
for (let r = 0; r < maxRows; r++) {
  const row = document.createElement("div");
  row.className = "row";
  const cells = [];
  for (let c = 0; c < 5; c++) {
    const cell = document.createElement("div");
    cell.className = "cell";
    row.appendChild(cell);
    cells.push(cell);
  }
  game.appendChild(row);
  rows.push(cells);
}

const msg = document.getElementById("msg");
const overlay = document.getElementById("overlay");
const rulesOverlay = document.getElementById("rulesOverlay");
const startOverlay = document.getElementById("startOverlay");
const result = document.getElementById("result");
const solutionBox = document.getElementById("solution");
const menuBtn = document.getElementById("menuBtn");
const menu = document.getElementById("menu");

function showMsg(t) {
  msg.textContent = t;
  setTimeout(() => msg.textContent = "", 2000);
}

// Render corretto dei colori
function renderGuess(guess, shouldSave = true) { 
    guess = guess.trim().toLowerCase();
    const sol = solution.split("");
    const count = {};
    sol.forEach(c => count[c] = (count[c] || 0) + 1);

    const rowCells = rows[currentRow];
    const results = new Array(5);

    // Primo passaggio: identifica corretti
    guess.split("").forEach((c, i) => {
        if (c === sol[i]) {
            results[i] = "correct";
            count[c]--;
        }
    });

    // Secondo passaggio: identifica presenti o assenti
    guess.split("").forEach((c, i) => {
        if (results[i]) return;
        if (sol.includes(c) && count[c] > 0) {
            results[i] = "present";
            count[c]--;
        } else {
            results[i] = "absent";
        }
    });

    // Applicazione animazione con delay
    guess.split("").forEach((c, i) => {
        const cell = rowCells[i];
        
        // Se stiamo ripristinando la sessione, non animare, colora subito
        if (!shouldSave) {
            cell.textContent = c.toUpperCase();
            cell.classList.add(results[i]);
        } else {
            // Animazione a cascata (0.1s di distanza tra lettere)
            setTimeout(() => {
                cell.classList.add("flip");
                
                // Cambia colore a metÃ  rotazione (0.3s)
                setTimeout(() => {
                    cell.textContent = c.toUpperCase();
                    cell.classList.add(results[i]);
                }, 300);
            }, i * 150);
        }
    });

    guesses.push(guess);
    currentRow++;
    
    if (shouldSave) {
        localStorage.setItem("wordleSardoState", JSON.stringify({day: dayIndex, guesses: guesses}));
    }
}

function submitGuess() {
  if (!gameEnabled || currentGuess.length !== 5) return;

  currentGuess = currentGuess.trim().toLowerCase();
  if (!WORD_SET.has(currentGuess)) {
    showMsg("Sa parola non esistit ðŸ˜¤");
    // Opzionale: aggiungi qui un piccolo effetto shake alla riga
    return;
  }

  // Disabilita temporaneamente l'input per evitare doppi invii durante l'animazione
  gameEnabled = false; 

  renderGuess(currentGuess);

  // Controlla se il gioco Ã¨ finito
  const isWin = currentGuess === solution;
  const isGameOver = currentRow >= maxRows;

  if (isWin || isGameOver) {
    // Aspettiamo 1.5 secondi (il tempo dei 5 flip) prima di mostrare il popup
    setTimeout(() => {
      showEnd();
    }, 1500);
  } else {
    // Se la partita continua, riabilita la tastiera dopo l'animazione
    setTimeout(() => {
      gameEnabled = true;
    }, 1200);
  }
  
  currentGuess = "";
}

// Generazione testo condivisibile
function buildShare() {
  let gridText = "";
  guesses.forEach((g, r) => {
    let rowEmoji = "";
    for (let i = 0; i < 5; i++) {
      const c = rows[r][i];
      if (c.classList.contains("correct")) rowEmoji += "ðŸŸ©";
      else if (c.classList.contains("present")) rowEmoji += "ðŸŸ¨";
      else rowEmoji += "â¬›";
    }
    gridText += rowEmoji + "\n";
  });

  // Rimuoviamo eventuali spazi bianchi accidentali all'inizio o fine
  gridText = gridText.trim();

  window.shareText = "Wordle Sardo " + dayIndex + " " +
    (guesses[guesses.length - 1] === solution ? guesses.length + "/6" : "X/6") +
    "\n\n" + gridText;
}
function loadStats() {
  const stats = JSON.parse(localStorage.getItem("wordleSardoStats") || '{}');
  return {
    wins: stats.wins || 0,
    losses: stats.losses || 0,
    streak: stats.streak || 0,
    maxStreak: stats.maxStreak || 0,
    winDist: stats.winDist || [0,0,0,0,0,0],
    lastPlayedDay: stats.lastPlayedDay ?? -1 // <--- Aggiunto per tracciare l'ultimo giorno giocato
  };
}

function showStats(win, attempts, isNewResult = true) { // <--- Aggiunto isNewResult
  const stats = loadStats();
  
  // Aggiorna i contatori solo se Ã¨ una partita appena finita, non se sto ricaricando
  if (isNewResult && stats.lastPlayedDay !== dayIndex) {
    if (win) {
      stats.wins++;
      stats.streak++;
      if (stats.streak > stats.maxStreak) stats.maxStreak = stats.streak;
      stats.winDist[attempts - 1]++;
    } else {
      stats.losses++;
      stats.streak = 0;
    }
    stats.lastPlayedDay = dayIndex;
    saveStats(stats);
  }

  let perc = stats.wins + stats.losses > 0 ? Math.round(100 * stats.wins / (stats.wins + stats.losses)) : 0;
  const gridPart = window.shareText.split("\n\n")[1]?.trim() || "";

  solutionBox.innerHTML = `<div style="display:inline-block;text-align:center;letter-spacing:2px;">${gridPart}</div><div style="text-align:left;margin-top:20px;font-family:sans-serif;font-size:14px;width:100%;max-width:250px;"><strong>STATISTICHE</strong><br>Vittorie: ${stats.wins} (${perc}%)<br>Serie: ${stats.streak} (max ${stats.maxStreak})<br>Sconfitte: ${stats.losses}<br><br><strong>DISTRIBUZIONE:</strong><br>${stats.winDist.map((n,i)=>`<strong>${i+1}</strong>:${n}`).join(" | ")}</div>`;
}
function saveStats(stats) {
  localStorage.setItem("wordleSardoStats", JSON.stringify(stats));
}



async function doShare() {
  buildShare();
  
  // Se il browser supporta la condivisione nativa (WhatsApp, Telegram, etc. su Mobile)
  if (navigator.share) {
    try {
      await navigator.share({
        title: 'Wordle Sardo',
        text: window.shareText
      });
    } catch (err) {
      console.log("Condivisione annullata o fallita");
    }
  } else {
    // Fallback per PC: copia negli appunti
    try {
      await navigator.clipboard.writeText(window.shareText);
      alert("Risultato copiato negli appunti! Incollalo dove vuoi.");
    } catch (err) {
      // Fallback estremo: WhatsApp Web
      const waUrl = "https://web.whatsapp.com/send?text=" + encodeURIComponent(window.shareText);
      window.open(waUrl, "_blank");
    }
  }
}
 function useHelp() {
    if (!gameEnabled || currentRow >= maxRows) return;

    // Sceglie una parola a caso dal dizionario WORDS
    const randomWord = WORDS[Math.floor(Math.random() * WORDS.length)];
    
    // Popola la variabile del tentativo corrente
    currentGuess = randomWord;

    // Aggiorna visivamente le caselle della riga corrente
    for (let i = 0; i < 5; i++) {
        rows[currentRow][i].textContent = randomWord[i].toUpperCase();
    }

    showMsg("Axudu prÃ¨stitu! âœ¨");
    
    // Invia automaticamente il tentativo
    submitGuess();
}
  function restoreSession() {
    const saved = localStorage.getItem("wordleSardoState");
    if (!saved) return;
    
    const state = JSON.parse(saved);
    // Se il giorno Ã¨ diverso, cancella il vecchio stato (nuova parola!)
    if (state.day !== dayIndex) {
        localStorage.removeItem("wordleSardoState");
        return;
    }

    // Ricostruisce la griglia con i vecchi tentativi
    state.guesses.forEach(g => {
        renderGuess(g, false); // false per non sovrascrivere il save mentre carichi
    });

    // Se la partita era giÃ  finita, blocca il gioco e mostra i risultati
    if (guesses.length > 0) {
        const last = guesses[guesses.length - 1];
        if (last === solution || guesses.length >= maxRows) {
            startOverlay.classList.remove("show"); // Nasconde il tasto GIOCA
            showEnd(false); // Carica le statistiche senza incrementarle
        }
    }
}
function showEnd(isNew = true, surrendered = false) { 
  gameEnabled = false; 
  const win = !surrendered && guesses.length > 0 && guesses[guesses.length - 1] === solution;
  
  if (surrendered) {
      result.textContent = "TI SEI ARRESO ðŸ³ï¸";
  } else {
      result.textContent = win ? "BRAVU" : "SPACCIAU";
  }
  
  // Mostra comunque la soluzione
  result.textContent += " (" + solution.toUpperCase() + ")";
  
  buildShare();
  showStats(win, guesses.length, isNew);
  overlay.classList.add("show");
}
// TASTIERA VIRTUALE
document.querySelectorAll("#keyboard button").forEach(b => {
  b.onclick = () => {
    if (!gameEnabled) return;
    const k = b.textContent;

    if (k === "ENTER") submitGuess();
    else if (k === "âŒ«") {
      if (currentGuess.length > 0) {
        currentGuess = currentGuess.slice(0, -1);
        rows[currentRow][currentGuess.length].textContent = "";
      }
    } else if (currentGuess.length < 5) {
      currentGuess += k.toLowerCase();
      rows[currentRow][currentGuess.length - 1].textContent = k.toUpperCase();
    }
  };
});

// TASTIERA FISICA
document.addEventListener("keydown", e => {
  if (!gameEnabled) return;
  const k = e.key.toUpperCase();

  if (k === "ENTER") submitGuess();
  else if (k === "BACKSPACE") {
    if (currentGuess.length > 0) {
      currentGuess = currentGuess.slice(0, -1);
      rows[currentRow][currentGuess.length].textContent = "";
    }
  } else if (/^[A-Z]$/.test(k) && currentGuess.length < 5) {
    currentGuess += k.toLowerCase();
    rows[currentRow][currentGuess.length - 1].textContent = k.toUpperCase();
  }
});

// MENU
menuBtn.onclick = () => {
  menu.style.display = menu.style.display === "block" ? "none" : "block";
};

// PULSANTI MENU
document.getElementById("openRules").onclick = () => rulesOverlay.classList.add("show");
document.getElementById("rulesOk").onclick = () => rulesOverlay.classList.remove("show");
document.getElementById("menuRules").onclick = () => {
  rulesOverlay.classList.add("show");
  menu.style.display = "none";
};

document.getElementById("menuClose").onclick = () => menu.style.display = "none";
document.getElementById("closeBtn").onclick = () => overlay.classList.remove("show");

// START
// START
document.getElementById("startPlay").onclick = () => {
  startOverlay.classList.remove("show");
  gameEnabled = true;
};

// Funzione Arrenditi (messa fuori da startPlay cosÃ¬ Ã¨ pulita)
// Funzione Arrenditi
document.getElementById("menuSurrender").onclick = () => {
  // Se la tastiera Ã¨ disabilitata o il popup finale Ã¨ giÃ  visibile, non fare nulla
  if (!gameEnabled || overlay.classList.contains("show")) {
      showMsg("Sa partita Ã¨ giai finia! ðŸ˜‰"); // Opzionale: un messaggio che dice che Ã¨ finita
      menu.style.display = "none";
      return;
  }
  
  if (confirm("Ti vuoi arrendere? La partita verrÃ  contata come persa.")) {
      menu.style.display = "none";
      showEnd(true, true); 
  }
};

document.getElementById("shareBtn").onclick = doShare;
// Azione pulsante Aiuto
document.getElementById("helpBtn").onclick = () => {
    if (confirm("Vuoi un aiuto? VerrÃ  inserita una parola casuale.")) {
        useHelp();
    }
};

// Azione pulsante Arrenditi
document.getElementById("surrenderBtn").onclick = () => {
    if (!gameEnabled || overlay.classList.contains("show")) return;

    if (confirm("Ti vuoi arrendere? La partita sarÃ  contata come persa.")) {
        showEnd(true, true); // Chiama la funzione di fine gioco come "arreso"
    }
};
// Ripristina la sessione all'avvio
restoreSession();
</script>
</body>
</html>
