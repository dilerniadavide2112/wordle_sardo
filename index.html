<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Wordle Sardo</title>

<style>
body{
  font-family:system-ui,sans-serif;
  background:#111;
  color:#eee;
  display:flex;
  justify-content:center;
}

.container{
  margin-top:20px;
  text-align:center;
  width:95vw;
  max-width:500px;
  position:relative;
}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}

h1{letter-spacing:.3em;margin:0}

.menu-btn{
  font-size:26px;
  cursor:pointer;
  user-select:none;
}

.row{display:flex;justify-content:center}

.cell{
  flex:1 1 18%;
  min-width:40px;
  max-width:60px;
  aspect-ratio:1/1;
  border:2px solid #333;
  margin:3px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:24px;
  font-weight:600;
  text-transform:uppercase;
  transform-style:preserve-3d;
}

.flip{
  animation:flip .6s ease forwards;
}

@keyframes flip{
  0%{transform:rotateX(0)}
  50%{transform:rotateX(90deg)}
  100%{transform:rotateX(0)}
}

.correct{background:#538d4e;border-color:#538d4e}
.present{background:#b59f3b;border-color:#b59f3b}
.absent{background:#3a3a3c;border-color:#3c3c3c}

#keyboard{margin-top:20px}
.keyrow{display:flex;justify-content:center;margin-bottom:6px}
#keyboard button{
  background:#818384;
  color:#fff;
  border:none;
  margin:3px;
  height:48px;
  min-width:32px;
  border-radius:4px;
  font-weight:600;
}
#keyboard .wide{min-width:60px}
#keyboard button.correct{background:#538d4e}
#keyboard button.present{background:#b59f3b}
#keyboard button.absent{background:#3a3a3c}

.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:10;
}
.show{display:flex}

.modal{
  background:#222;
  padding:25px;
  border-radius:12px;
  max-width:90%;
  text-align:center;
}

.menu{
  position:absolute;
  top:40px;
  right:10px;
  background:#222;
  border-radius:10px;
  padding:10px;
  display:none;
  z-index:5;
}
.menu button{
  display:block;
  width:100%;
  margin:6px 0;
}

button{
  padding:10px 20px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
.primary{background:#538d4e;color:#fff}
.secondary{background:#555;color:#fff}
</style>
</head>

<body>

<div id="startOverlay" class="overlay show">
  <div class="modal">
    <h2>WORDLE SARDO</h2>
    <button class="primary" id="startPlay">GIOCA</button>
    <button class="secondary" id="openRules">REGOLE</button>
  </div>
</div>

<div id="rulesOverlay" class="overlay">
  <div class="modal">
    <h2>REGOLE</h2>
    <p>Indovina sa parola de 5 letras in 6 tentativos.</p>
    <p>ðŸŸ© giusta e postu giustu</p>
    <p>ðŸŸ¨ giusta postu sbagliadu</p>
    <p>â¬› non est in sa parola</p>
    <button class="primary" id="rulesOk">OK</button>
  </div>
</div>

<div id="overlay" class="overlay">
  <div class="modal">
    <h2 id="result"></h2>
    <pre id="solution"></pre>
    <button class="primary" id="shareBtn">Condividi</button>
    <button class="secondary" id="closeBtn">Chiudi</button>
  </div>
</div>

<div class="container">
  <header>
    <h1>WORDLE</h1>
    <div class="menu-btn" id="menuBtn">â˜°</div>
  </header>

  <div class="menu" id="menu">
    <button class="secondary" id="menuRules">Regole</button>
    <button class="secondary" id="menuShare">Condividi</button>
    <button class="secondary" id="menuClose">Chiudi</button>
  </div>

  <div id="game"></div>

  <div id="keyboard">
    <div class="keyrow">
      <button>Q</button><button>W</button><button>E</button><button>R</button>
      <button>T</button><button>Y</button><button>U</button><button>I</button>
      <button>O</button><button>P</button>
    </div>
    <div class="keyrow">
      <button>A</button><button>S</button><button>D</button><button>F</button>
      <button>G</button><button>H</button><button>J</button><button>K</button>
      <button>L</button>
    </div>
    <div class="keyrow">
      <button class="wide">ENTER</button>
      <button>Z</button><button>X</button><button>C</button>
      <button>V</button><button>B</button><button>N</button><button>M</button>
      <button class="wide">âŒ«</button>
    </div>
  </div>
</div>

<script>
let gameEnabled=false;
const WORDS=["cantu","terra","limba","domus","abbae","bentu"];
const epoch=new Date(2023,0,1);
const dayIndex=Math.floor((Date.now()-epoch)/86400000);
const solution=WORDS[dayIndex%WORDS.length];
const maxRows=6;
let currentRow=0,currentGuess="",guesses=[];

const game=document.getElementById("game");
const rows=[];
for(let r=0;r<maxRows;r++){
  const row=document.createElement("div");
  row.className="row";
  const cells=[];
  for(let c=0;c<5;c++){
    const cell=document.createElement("div");
    cell.className="cell";
    row.appendChild(cell);
    cells.push(cell);
  }
  game.appendChild(row);
  rows.push(cells);
}

function renderGuess(guess){
  const sol=solution.split("");
  const count={};
  sol.forEach(c=>count[c]=(count[c]||0)+1);

  guess.split("").forEach((c,i)=>{
    const cell=rows[currentRow][i];
    cell.textContent=c;
    cell.classList.add("flip");
    if(c===sol[i]){cell.classList.add("correct");count[c]--;}
  });

  setTimeout(()=>{
    guess.split("").forEach((c,i)=>{
      const cell=rows[currentRow][i];
      if(cell.classList.contains("correct"))return;
      if(sol.includes(c)&&count[c]>0){cell.classList.add("present");count[c]--;}
      else cell.classList.add("absent");
    });
  },300);

  guesses.push(guess);
  currentRow++;
}

function submitGuess(){
  if(!gameEnabled||currentGuess.length!==5)return;
  renderGuess(currentGuess);
  if(currentGuess===solution||currentRow>=maxRows)showEnd();
  currentGuess="";
}

function showEnd(){
  result.textContent=currentGuess===solution?"BRAVU":"SPACCIAU";
  let t="";
  guesses.forEach((g,r)=>{
    for(let i=0;i<5;i++){
      const c=rows[r][i];
      t+=c.classList.contains("correct")?"ðŸŸ©":c.classList.contains("present")?"ðŸŸ¨":"â¬›";
    }
    t+="\n";
  });
  window.shareText="Wordle Sardo "+(currentGuess===solution?guesses.length+"/6":"X/6")+"\n\n"+t;
  solution.textContent=t;
  overlay.classList.add("show");
}

document.querySelectorAll("#keyboard button").forEach(b=>{
  b.onclick=()=>{
    if(!gameEnabled)return;
    const k=b.textContent;
    if(k==="ENTER")submitGuess();
    else if(k==="âŒ«"){
      currentGuess=currentGuess.slice(0,-1);
      rows[currentRow][currentGuess.length].textContent="";
    }else if(currentGuess.length<5){
      currentGuess+=k.toLowerCase();
      rows[currentRow][currentGuess.length-1].textContent=k;
    }
  };
});

menuBtn.onclick=()=>menu.style.display=menu.style.display==="block"?"none":"block";
menuClose.onclick=()=>menu.style.display="none";
menuRules.onclick=()=>{menu.style.display="none";rulesOverlay.classList.add("show");};
menuShare.onclick=()=>{menu.style.display="none";navigator.share&&navigator.share({text:window.shareText});};

startPlay.onclick=()=>{startOverlay.classList.remove("show");gameEnabled=true};
openRules.onclick=()=>rulesOverlay.classList.add("show");
rulesOk.onclick=()=>rulesOverlay.classList.remove("show");
shareBtn.onclick=()=>navigator.share&&navigator.share({text:window.shareText});
closeBtn.onclick=()=>overlay.classList.remove("show");
</script>

</body>
</html>
