<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Wordle Sardo</title>
<style>
body { font-family: system-ui, sans-serif; background:#111; color:#eee; display:flex; justify-content:center; }
.container { margin-top:30px; text-align:center; width:95vw; max-width:500px; position:relative; }
h1 { letter-spacing:0.3em; margin-bottom:20px; }
.row { display:flex; justify-content:center; }
.cell { flex:1 1 18%; min-width:40px; max-width:60px; height:auto; aspect-ratio:1/1; border:2px solid #333; margin:3px; display:flex; align-items:center; justify-content:center; font-size:24px; font-weight:600; text-transform:uppercase; }
.correct { background:#538d4e; border-color:#538d4e; }
.present { background:#b59f3b; border-color:#b59f3b; }
.absent { background:#3a3a3c; border-color:#3c3c3c; }
@keyframes pop {0%{transform:scale(0.8);opacity:0}100%{transform:scale(1);opacity:1}}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;}
.modal{background:#222;padding:30px;border-radius:12px;animation:pop .3s ease-out;text-align:center;white-space:pre-line;}
.modal h2{letter-spacing:.2em;margin-bottom:10px;}
.show{display:flex;}
#keyboardInput{position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:90%;height:40px;opacity:0.01;font-size:24px;}
.shareBtn{margin-top:15px;padding:10px 20px;font-size:16px;border:none;border-radius:6px;background:#538d4e;color:#fff;cursor:pointer;}
.closeBtn{margin-top:10px;padding:5px 10px;font-size:14px;border:none;border-radius:6px;background:#555;color:#fff;cursor:pointer;}
</style>
</head>
<body>
<div class="container">
<h1>WORDLE SARDO</h1>
<div id="game"></div>
<input id="keyboardInput" type="text" maxlength="5" autocorrect="off" autocomplete="off" spellcheck="false">
</div>

<div id="overlay" class="overlay">
<div class="modal">
<h2 id="result"></h2>
<p id="solution"></p>
<button class="shareBtn" id="shareBtn">Condividi</button>
<button class="closeBtn" id="closeBtn">Chiudi</button>
</div>
</div>

<script>
const WORDS = ["cantu","terra","limba","domus","abbae","abbas","agusu","akatu",
"amore","annos","arras","artu","asinu","attzu","bacca","ballu","battu",
"berru","bidda","binu","boghe","bonu","braxu","bussu","cabbu","caded",
"camin","campu","canes","capru","carri","ceddu","chelu","chena","chida",
"chidu","coggi","conca","corru","costa","craba","crobu","cuadu","curre",
"dente","dinai","dridu","fangu","fattu","femmu","ferro","figus","filu",
"foghe","forru","fradi","frori","fundu","gattu","genna","giara","goccu",
"granu","herra","ibidu","istru","latte","legnu","libru","littu","logu",
"macas","manus","mattu","melis","menta","merca","metru","missa","molle",
"monte","moru","mughe","nassa","niedu","ninnu","nuddu","olivu","omini",
"orru","pane","pedde","perda","pietu","pilus","pinna","pitzus","planu",
"ponte","porru","pratu","prenu","punta","putzu","rabbu","randa","rattu",
"riccu","rimas","rinnu","rocca","roghe","rueda","sabba","santu","sartu",
"sedda","serra","siddu","sinnu","solee","sonnu","spina","stadu","stolu",
"suddu","tabba","tanca","tattu","terru","tissu","torru","trigu","umbra",
"undas","ungra","usciu","vacca","valle","vesta","vidda","vinu","virga",
"zente","zinnu","bentu"];

const epoch=new Date(2025,0,1);
const dayIndex=Math.floor((Date.now()-epoch)/86400000);
const solution=WORDS[dayIndex%WORDS.length];
const storageKey="wordle-sardo-"+dayIndex;

const maxRows=6;
const game=document.getElementById("game");
let currentRow=0;
let currentGuess="";
let guesses=[];

const rows=[];
for(let r=0;r<maxRows;r++){
  const row=document.createElement("div");row.className="row";
  const cells=[];for(let c=0;c<5;c++){const cell=document.createElement("div");cell.className="cell";row.appendChild(cell);cells.push(cell);}
  game.appendChild(row);rows.push(cells);
}

const saved=localStorage.getItem(storageKey);
if(saved){
  const data=JSON.parse(saved);
  data.guesses.forEach(g=>renderGuess(g));
  showOverlay(data.guesses.length);
}

// input mobile
const input=document.getElementById("keyboardInput");
document.querySelector(".container").addEventListener("click",()=>input.focus());

function renderGuess(guess){
  const solArr=solution.split("");const solCount={};solArr.forEach(ch=>solCount[ch]=(solCount[ch]||0)+1);
  guess.split("").forEach((ch,i)=>{const cell=rows[currentRow][i];cell.textContent=ch;if(ch===solArr[i]){cell.classList.add("correct");solCount[ch]--;}});

  guess.split("").forEach((ch,i)=>{const cell=rows[currentRow][i];if(cell.classList.contains("correct")) return;if(solArr.includes(ch)&&solCount[ch]>0){cell.classList.add("present");solCount[ch]--;}else{cell.classList.add("absent");}});
  guesses.push(guess);currentRow++;
}

function submitGuess(){
  if(currentGuess.length!==5 || currentRow>=maxRows) return;
  renderGuess(currentGuess);
  localStorage.setItem(storageKey, JSON.stringify({guesses}));
  if(currentGuess===solution) showOverlay(currentRow);
  else if(currentRow>=maxRows) showOverlay(currentRow);
  currentGuess="";
  input.value="";
}

function showOverlay(tentativi){
  document.getElementById("result").textContent=tentativi<=maxRows && guesses[guesses.length-1]===solution ? "BRAVU" : "FINIDU";
  document.getElementById("solution").textContent="Tentativi: "+tentativi+"/"+maxRows;
  generateShareText();
  document.getElementById("overlay").classList.add("show");
}

function generateShareText(){
  let text="Wordle Sardo "+dayIndex+" "+guesses.length+"/"+maxRows+"\n\n";
  guesses.forEach(g=>{
    for(let i=0;i<5;i++){
      const cell=rows[guesses.indexOf(g)][i];
      if(cell.classList.contains("correct")) text+="ðŸŸ©";
      else if(cell.classList.contains("present")) text+="ðŸŸ¨";
      else text+="â¬›";
    }
    text+="\n";
  });
  window.shareText=text;
}

// condividi
document.getElementById("shareBtn").addEventListener("click",()=>{
  if(navigator.share){
    navigator.share({text:window.shareText});
  } else {
    const url="https://api.whatsapp.com/send?text="+encodeURIComponent(window.shareText);
    window.open(url,"_blank");
  }
});

document.getElementById("closeBtn").addEventListener("click",()=>{
  document.getElementById("overlay").classList.remove("show");
});

// input mobile
input.addEventListener("input",e=>{
  const val=e.target.value.toLowerCase().slice(0,5);
  currentGuess=val;
  for(let i=0;i<5;i++) rows[currentRow][i].textContent=val[i]||"";
});

input.addEventListener("keydown",e=>{
  if(e.key==="Enter") submitGuess();
  else if(e.key==="Backspace"){
    currentGuess=currentGuess.slice(0,-1);
    rows[currentRow][currentGuess.length].textContent="";
  }
});

// tastiera PC
window.addEventListener("keydown",e=>{
  if(currentRow>=maxRows) return;
  if(e.key==="Enter") submitGuess();
  else if(e.key==="Backspace"){currentGuess=currentGuess.slice(0,-1);rows[currentRow][currentGuess.length].textContent="";}
  else if(/^[a-zA-Z]$/.test(e.key)&&currentGuess.length<5){const ch=e.key.toLowerCase();rows[currentRow][currentGuess.length].textContent=ch;currentGuess+=ch;}
});
</script>
</body>
</html>
